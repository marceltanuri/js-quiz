<!DOCTYPE html>
<html lang="en">
<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://smtpjs.com/v3/smtp.js"></script>
    <link href="https://vjs.zencdn.net/7.6.6/video-js.css" rel="stylesheet" />
    <script src="https://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>
 </head>

<body>
    <div class="container">
        <div class="row">
          <div class="col-sm text-center">
            <h1>Controle de Acesso</h1>
          </div>
        </div>
        <div class="row"></div>
          <hr/>
          <br/><br/>
        </div>
        <div id="video" class="text-center">
          <iframe id="iframe_video" width="760" height="515" frameborder="0" src="https://www.youtube.com/embed/-zQ3iKrFeJ0?rel=0&autoplay=1&modestbranding=1&showinfo=0&controls=0" allow="accelerometer; autoplay; encrypted-media; gyroscope" allowfullscreen></iframe>
            <!-- <iframe id="iframe" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true" src="https://drive.google.com/file/d/1eBF0esEYB5aAcm0BEaCWTgqRMx0lgrPz/preview?autoplay=0"  width="600" height="400"></iframe> -->
            <!-- <video
    id="my-video"
    class="video-js"
    controls
    preload="auto"
    width="640"
    height="264"
    poster="MY_VIDEO_POSTER.jpg"
    data-setup="{}"
  >
    <source src="Portugues1.mp4" type="video/mp4" />
    <source src="Portugues1.mp4" type="video/webm" />
    <p class="vjs-no-js">
      To view this video please enable JavaScript, and consider upgrading to a
      web browser that
      <a href="https://videojs.com/html5-video-support/" target="_blank"
        >supports HTML5 video</a
      >
    </p>
  </video>

  <script src="https://vjs.zencdn.net/7.6.6/video.js"></script> -->
        <div class="form-group" style="margin-top: 20px;">
              <button type="button" onclick="$('#video').hide(400); $('#dadospessoais').show(400);" class="btn btn-primary">Próximo</button>
        </div>
        </div> 
        <div id="dadospessoais" style="display: none;" class="col-sm col-lg-6 offset-lg-3">
            <form id="form_dadospessoais">
                <div class="form-group">
                <label for="nome">Nome Completo</label>
                <input requiredd type="text" class="form-control" id="nome">
                </div>
                <div class="form-group">
                    <label for="cpf">CPF</label>
                    <input requiredd type="number" class="form-control" id="cpf">
                </div>
                <div class="form-group">
                    <label for="empresa">Empresa</label>
                    <input requiredd type="text" class="form-control" id="empresa">
                </div>
                <div class="form-group">
                    <label for="funcao">Função</label>
                    <input requiredd type="text" class="form-control" id="funcao">
                </div>
                <div class="form-group">
                    <label for="funcao">Telefone</label>
                    <input requiredd type="tel" pattern="[0-9]{2} [0-9]{5}-[0-9]{4}" class="form-control" id="telefone">
                </div>
                <div class="form-group">
                  <label for="funcao">E-mail</label>
                  <input requiredd type="email" class="form-control" id="email">
              </div>
                <div style="float: right;">
                  <button type="button" onclick="$('#dadospessoais').hide(400); $('#video').show(400);" class="btn btn-primary">Anterior</button>&nbsp;&nbsp;&nbsp;
                  <button type="submit" class="btn btn-primary">Próximo</button>
                </div>
            </form>
        </div>
        <div id="questao1" class="questao col-sm col-lg-6 offset-lg-3" style="display: none;">
            <h4>Questão 01 </h4>
            <span>O que o toque do alarme INTERMITENTE significa? Assinale a alternativa correta</span>
            <br/><br/>
            <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q1optradio">Final da Emergência
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" data-gabarito='true' name="q1optradio">Horário de Almoço
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q1optradio">Situação de Emergência
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q1optradio">Final de Expediente
                </label>
              </div>
              <br/>
            <br/><br/>
            <button type="button" onclick="$('#questao1').hide(400); $('#dadospessoais').show(400);" class="btn btn-primary">Anterior</button>&nbsp;&nbsp;&nbsp;
            <button type="button" onclick="$('#questao1').hide(400); $('#questao2').show(400);" class="btn btn-primary">Próximo</button>
        </div>
        <div id="questao2" class="questao col-sm col-lg-6 offset-lg-3" style="display: none;">
            <h4>Questão 02 </h4>
            <span>O que fazer quando soar o alarme de emergência? Assinale a alternativa correta:</span>
            <br/><br/>
            <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q2optradio">Correr imediatamente para o local da emergência e combate-la
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q2optradio">Correr para a enfermaria ou para a área de emergência
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q2optradio">Ligar para o ramal 999
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" data-gabarito='true' name="q2optradio">Manter a calma e seguir orientação do Monitor de Área ou funcionário Oxiteno Responsável pela Área.
                </label>
              </div>
              <br/>
            <br/><br/>
            <button type="button" onclick="$('#questao2').hide(400); $('#questao1').show(400);" class="btn btn-primary">Anterior</button>&nbsp;&nbsp;&nbsp;
            <button type="button" onclick="$('#questao2').hide(400); $('#questao3').show(400);" class="btn btn-primary">Próximo</button>
        </div>
        <div id="questao3" class="questao col-sm col-lg-6 offset-lg-3" style="display: none;">
            <h4>Questão 03 </h4>
            <span>Quais são os Equipamentos de Proteção Individual (EPI's) básicos, obrigatórios para acessar as áreas produtivas? Assinale mais de uma alternativa:</span>
            <br/><br/>
            <div class="form-check">
                <label class="form-check-label">
                  <input type="checkbox" class="form-check-input" data-gabarito='true' name="q3optradio">Capacete
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="checkbox" class="form-check-input" name="q3optradio">Cinto de segurança tipo pára-quedista
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="checkbox" class="form-check-input" name="q3optradio">Óculos de segurança ampla visão
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="checkbox" class="form-check-input" name="q3optradio">Bota ou calçado de segurança
                </label>
              </div>
              <br/>
            <br/><br/>
            <button type="button" onclick="$('#questao3').hide(400); $('#questao2').show(400);" class="btn btn-primary">Anterior</button>&nbsp;&nbsp;&nbsp;
            <button type="button" onclick="$('#questao3').hide(400); $('#questao4').show(400);" class="btn btn-primary">Próximo</button>
        </div>
        <div id="questao4" class="questao col-sm col-lg-6 offset-lg-3" style="display: none;">
            <h4>Questão 04 </h4>
            <span>É proibido fumar na área industrial, exceto nos locais onde houver placa com os dizeres: "É Permitido Fumar Neste Local." Não se deve portar cigarros, fósforos ou isqueiros nas áreas de processo/laboratórios e em outros locais classificados como "Área Restrita".</span>
            <br/><br/>
            <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" data-gabarito='true' name="q4optradio">Verdadeiro
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q4optradio">Falso
                </label>
              </div>
            <br/><br/>
            <button type="button" onclick="$('#questao4').hide(400); $('#questao3').show(400);" class="btn btn-primary">Anterior</button>&nbsp;&nbsp;&nbsp;
            <button type="button" onclick="$('#questao4').hide(400); $('#questao5').show(400);" class="btn btn-primary">Próximo</button>
        </div>
        <div id="questao5" class="questao col-sm col-lg-6 offset-lg-3" style="display: none;">
            <h4>Questão 05 </h4>
            <span>Qual a velocidade máxima permitida para o trânsito de veículos dentro das dependências da Oxiteno? Assinale a alternativa correta:</span>
            <br/><br/>
            <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q5optradio" data-gabarito='true'>20 km/h
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q5optradio">80 km/h
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q5optradio">50 km/h
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q5optradio">Não há restrição
                </label>
              </div>
            <br/><br/>
            <button type="button" onclick="$('#questao5').hide(400); $('#questao4').show(400);" class="btn btn-primary">Anterior</button>&nbsp;&nbsp;&nbsp;
            <button type="button" onclick="$('#questao5').hide(400); $('#questao6').show(400);" class="btn btn-primary">Próximo</button>
        </div>
        <div id="questao6" class="questao col-sm col-lg-6 offset-lg-3" style="display: none;">
            <h4>Questão 06 </h4>
            <span>É proibida a utilização de Telefone Celular, Pager e/ou Nextel no recinto industrial. O uso está restrito ao interior dos prédios administrativos (situados fora das Áreas Industriais).</span>
            <br/><br/>
            <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" data-gabarito='true' name="q6optradio">Verdadeiro
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q6optradio">Falso
                </label>
              </div>
            <br/><br/>
            <button type="button" onclick="$('#questao6').hide(400); $('#questao5').show(400);" class="btn btn-primary">Anterior</button>&nbsp;&nbsp;&nbsp;
            <button type="button" onclick="$('#questao6').hide(400); $('#questao7').show(400);" class="btn btn-primary">Próximo</button>
        </div>
        <div id="questao7" class="questao col-sm col-lg-6 offset-lg-3" style="display: none;">
            <h4>Questão 07 </h4>
            <span>Você leu e compreendeu as instruções contidas na ART-007 que trata sobre visita as instalações?</span>
            <br/><br/>
            <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" data-gabarito='true' name="q7optradio">Sim
                </label>
              </div>
              <br/>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" class="form-check-input" name="q7optradio">Não
                </label>
              </div>
              <br/>
            <br/><br/>
            <button type="button" onclick="$('#questao7').hide(400); $('#questao6').show(400);" class="btn btn-primary">Anterior</button>&nbsp;&nbsp;&nbsp;
            <button type="button" onclick="sendEmail();" class="btn btn-primary">Finalizar</button>
        </div>
    </div>
    <div class="row" style="height: 100px;">
      </div>
    
</body>
</html>

<script>
    function sendEmail(){

        var questoes = $('.questao').length;

        var acertos = 0;
        $('.form-check-input').each(function(){
            if($(this).is(':checked')){
                if($(this).data('gabarito')){
                    acertos++;
                }
            }
        });

        var pontos = (acertos/questoes)*100;

        if(pontos > 60){
        alert('Ótimo você fez ' + pontos.round(2) + ' pontos. Seu acesso está sendo liberado');
            Email.send({
                Host : "smtp.elasticemail.com",
                Username : "marcel.tanuri@gmail.com",
                Password : "76C3EC4BA74F0EB5C3878FF68A00E9E10F08",
                To : 'marcel.tanuri@gmail.com',
                From : "marcel.tanuri@gmail.com",
                Subject : "Novo cadastro de acesso",
                Body : "<h3>Dados pessoais:</h3>"+
                "Nome: <input type='text' value='"+$('#nome').val()+"'/><br/><br/>"+
                "CPF: <input type='text' value='"+$('#cpf').val()+"'/><br/><br/>"+
                "Empresa: <input type='text' value='"+$('#empresa').val()+"'/><br/><br/>"+
                "Função: <input type='text' value='"+$('#funcao').val()+"'/><br/><br/>"+
                "Telefone: <input type='text' value='"+$('#telefone').val()+"'/><br/><br/>"+
                "Email: <input type='text' value='"+$('#email').val()+"'/><br/><br/>"+
                "Pontos: " + pontos.round(2)
                }).then(
                    message => console.log(message)
                ); 
        }else{
            alert('Você não fez pontos suficiente. Tudo bem, assista o vídeo novamente e repita o teste.');
        }
            $(".questao").hide(400);
            $("#video").show(400);
    }

    Number.prototype.round = function(places) {
  return +(Math.round(this + "e+" + places)  + "e-" + places);
}

$(document).ready(function()
{
    $('#form_dadospessoais').submit(function(event){
        if(!this.checkValidity())
        {
            event.preventDefault();
        }
        else{
          $('#dadospessoais').hide(400);
          $('#questao1').show(400);
          event.preventDefault();
        }
    });
});

$("#iframe").ready(function(){
  $(this).click();
});


</script>
